properties:


  - name: font_bin
    type: AllegroFlare::FontBin*
    init_with: nullptr
    constructor_arg: true
  - name: list_items
    type: std::vector<std::tuple<std::string, std::string>>
    init_with: '{}'
    constructor_arg: true
  - name: cursor
    type: int
    init_with: 0


functions:


  - name: move_cursor_up
    type: bool
    body: |
      cursor--;
      return true;


  - name: move_cursor_down
    type: bool
    body: |
      cursor++;
      return true;


  - name: render
    type: void
    boards: [ is_primitives_addon_initialized() ]
    body: |
      ALLEGRO_FONT *font = obtain_list_item_font();
      ALLEGRO_COLOR color = ALLEGRO_COLOR{1, 0, 0, 1};
      ALLEGRO_COLOR off_color = ALLEGRO_COLOR{0, 0, 0, 1};
      float width = 600;
      //float height = 300;
      int line_height = al_get_font_line_height(font) * 1.2;

      // draw the box and pointer
      std::vector<float> points = { 100, 100,  300, 900,  1000, 500 };
      al_draw_ribbon(&points[0], sizeof(float) * 2, color, 2.0, 3);

      // draw background
      //al_draw_rectangle(0, 0, width, height);

      // draw text
      int y = 0;
      for (auto &list_item : list_items)
      {
         bool cursor_on_this_list_item = cursor == y;

         if (cursor_on_this_list_item)
         {
            // draw selection box
            al_draw_filled_rectangle(0, y * line_height, width, y * line_height + line_height, color);
         }

         std::string text_to_render = std::get<0>(list_item).c_str();
         std::transform(text_to_render.begin(), text_to_render.end(), text_to_render.begin(), ::toupper);

         al_draw_text(
            font,
            cursor_on_this_list_item ? off_color : color,
            0,
            0 + y * line_height,
            0,
            text_to_render.c_str()
         );
         y++;
      }

      return;
    body_dependency_symbols:
      - al_draw_filled_rectangle
      - std::transform


  - name: obtain_list_item_font
    type: ALLEGRO_FONT*
    guards: [ font_bin ]
    body: |
       return font_bin->auto_get("Exan-Regular.ttf -46");


dependencies:


  - symbol: al_draw_filled_rectangle
    headers: [ allegro5/allegro_primitives.h ]
  - symbol: std::vector<std::tuple<std::string, std::string>>
    headers: [ vector, tuple, string ]
  - symbol: AllegroFlare::FontBin*
    headers: [ AllegroFlare/FontBin.hpp ]
  - symbol: ALLEGRO_FONT*
    headers: [ allegro5/allegro_font.h ]
  - symbol: std::transform
    headers: [ algorithm ]

